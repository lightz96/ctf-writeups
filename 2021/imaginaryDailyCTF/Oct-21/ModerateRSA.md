# Imaginary Daily Oct 2021 - Moderate RSA
```
Now I'm not giving you any info about p and q!
```

## Challenge
We are given a script on how the plaintext is encrypted:
```python
#!/usr/bin/env python3.9

from Crypto.Util.number import *
from hidden import flag

p = getPrime(1024)
q = p

e = 65537
n = p*q

m = bytes_to_long(flag)

c = pow(m, e, n)

print(f'{n = }')
print(f'{c = }')
```

And the output of the script:
```
n = 29975631800215657937493783863434112683656294942535397520359150860573029054795899767788769927839149304708188758416887641277324280355613271400904941070611372140457117747662223408542405106215206995200207640758261893896200215166153490918602741293850663257912193639687548512449008979500245369494009704210415156213039607019531327061604637859325214944011158998420893005901040659256611528987528906699903072144264608066816642440797472378250674183630413359791534413445494769269248545141877414804990036775500895937772387000305554995582804772280076985804145965150014436992291857408253869932893321744363684924634962694994879194241
c = 25500436459642209804929797892185191563830907623710642006332858273529200970795010398088408382227890912519946589217033189053728965737823533005095213744703891336518467220488636343293826730864490790395257719113114481236123260380825419591689910506682091430326705083813705483660526850065632087765588829706773397671875286624248394879538433763453533726014259942265046685464201407307353905506287805265767203343183534177579910544814435687897276972182928656556075188061661685596460591543011739810067816920839319499324897516400443823188483995275388169572500559642017660320849138514326543977310947366163719956182053261225627880926
```

From the source, we know that n = p*q and p == q. 

The definition of phi is:
- If p and q are coprime, phi(N) = (p - 1)(q - 1)
- If N = p ^ k, phi(N) = p ^ (k - 1) * (p - 1) 


```python
from Crypto.Util.number import *

n = 29975631800215657937493783863434112683656294942535397520359150860573029054795899767788769927839149304708188758416887641277324280355613271400904941070611372140457117747662223408542405106215206995200207640758261893896200215166153490918602741293850663257912193639687548512449008979500245369494009704210415156213039607019531327061604637859325214944011158998420893005901040659256611528987528906699903072144264608066816642440797472378250674183630413359791534413445494769269248545141877414804990036775500895937772387000305554995582804772280076985804145965150014436992291857408253869932893321744363684924634962694994879194241
c = 25500436459642209804929797892185191563830907623710642006332858273529200970795010398088408382227890912519946589217033189053728965737823533005095213744703891336518467220488636343293826730864490790395257719113114481236123260380825419591689910506682091430326705083813705483660526850065632087765588829706773397671875286624248394879538433763453533726014259942265046685464201407307353905506287805265767203343183534177579910544814435687897276972182928656556075188061661685596460591543011739810067816920839319499324897516400443823188483995275388169572500559642017660320849138514326543977310947366163719956182053261225627880926
e = 65537

# From factordb
p = q = 173134721532729124430487469486147470886768832917404593204746493011342873824129006538958847119020749787502072160214617984336587638706443342092938187629026921811052635860585757965936258414139597652366717802539444703497131286438989597910698445873480746215504470855045890088790059361042838903409900951576037067329

assert p*q == n

phi = p * (q - 1)

d = pow(e, -1, phi)
print(long_to_bytes(pow(c, d, n)))
```

Flag: `ictf{totients_are_magic_things}`

## Reference
- https://stackoverflow.com/questions/67472553/rsa-crypto-when-p-q